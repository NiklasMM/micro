<template class="micro-ui-template">
    <header class="micro-ui-header" style="display: none;">
        <nav class="micro-ui-inside">
            <h1 class="micro-ui-logo">
                <a class="link" href="/" data-shortcut="new Shortcut 'N,S'">
                    <img/> <span class="micro-ui-logo-text"></span>
                    <span class="micro-ui-beta">Beta</span>
                </a>
            </h1>

            <div class="micro-ui-header-fill"></div>

            <ul is="micro-menu" class="micro-ui-menu micro-secondary">
                <li class="micro-ui-header-user">
                    <button class="link"><micro-user></micro-user></button>
                    <ul is="micro-menu">
                        <li class="micro-ui-edit-user">
                            <a class="action" href="/user/edit" data-shortcut="new Shortcut 'N,U'">
                                <span class="fa fa-fw fa-wrench"></span> Edit user settings
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="micro-ui-header-menu">
                    <button class="link"><span class="fa fa-fw fa-bars"></span></button>
                    <ul is="micro-menu">
                        <li class="micro-ui-feedback">
                            <a class="link" data-shortcut="new Shortcut 'N,F'">
                                <span class="fa fa-fw fa-question-circle"></span> Feedback &amp;
                                help
                            </a>
                        </li>
                        <li class="micro-ui-about">
                            <a class="link" href="/about" data-shortcut="new Shortcut 'N,A'">
                                <span class="fa fa-fw fa-info-circle"></span> About
                            </a>
                        </li>
                        <li class="micro-ui-activity">
                            <a class="link" href="/activity" data-shortcut="new Shortcut 'N,H'">
                                <span class="fa fa-fw fa-history"></span> Activity
                            </a>
                        </li>
                        <li class="micro-ui-edit-settings">
                            <a class="action" href="/settings/edit"
                               data-shortcut="new Shortcut 'N,C'">
                                <span class="fa fa-fw fa-wrench"></span> Edit site settings
                            </a>
                        </li>
                        <li class="micro-ui-keyboard compact" tabindex="0">
                            <p><i class="fa fa-fw fa-keyboard-o"></i> Keyboard navigation</p>
                            <ul>
                                <li><strong>Tab / Shift + Tab</strong>: Cycle through buttons</li>
                                <li><strong>J / K</strong>: Navigate lists</li>
                                <li>
                                    Select / hover over a button to see the associated keyboard
                                    shortcut
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>

        <div class="micro-ui-notification-space"></div>
    </header>
</template>
<style>
    .micro-ui-keyboard {
        padding: 0 calc(1.5rem / 4);
    }

    .micro-ui-keyboard i {
        color: var(--micro-color-text-subtle);
    }

    .micro-ui-keyboard ul {
        display: none;
        list-style: disc;
        font-size: 0.875em;
        white-space: normal;
    }

    .micro-ui-keyboard:hover ul,
    .micro-ui-keyboard:focus ul {
        display: block;
    }
</style>

<style>
    .micro-entity {
        margin: calc(1.5rem / 4) 0;
        display: inline-block;
        max-width: 100%;
        background: #ddd;
        /* Just testing, should also work */
        /*width: 100%;*/
    }

    .micro-entity a {
        /*background: transparent;*/
        /*background: #ddd;/* /* XXX why? */
    }

    .micro-entity > * {
        display: block;
        max-height: calc(70ch * 9 / 16);
        /* secondary style */
        max-height: calc(70ch * 9 / 16 / 2);
    }

    /*.micro-entity img {
        object-fit: contain;
    }*/
</style>

<template id="micro-link-entity-template">
    <a data-href="entity.url" target="_blank">
        <!-- TODO: title before summary would be awesome -->
        <!-- TODO: maybe favicon would be cool here -->
        <img data-src="or entity.image_url ''" />
        <div>
            <div class="micro-link-entity-icon" data-content="switch hasIcon">
                <template><img data-src="entity.icon"></img></template>
                <template><i class="fa fa-globe"></i></template>
            </div>
            <p><span data-content="entity.summary"></span></p>
        </div>
    </a>
</template>
<style>
    micro-link-entity.micro-entity > a {
        display: flex;
        flex-flow: column;
        overflow: hidden;
        align-items: center;
    }

    micro-link-entity a > img {
        flex: auto;
        min-height: 0;
        /* chrome wont keep aspect ratio of flex items */
        align-self: stretch;
        object-fit: cover;
        object-fit: cover scale-down;
        /*object-position: left center;*/
        /*object-fit: cover;*/
    }

    micro-link-entity > a > div {
        display: flex;
        flex: none;
        padding: calc(1.5em / 4);
        max-height: calc(2 * 1.5em + 1.5em / 2);
    }

    micro-link-entity a div i {
        color: var(--micro-color-text-subtle);
    }

    micro-link-entity > a > div > div {
        align-self: flex-start;
        margin-right: calc(1.5rem / 4);
    }

    micro-link-entity div img {
        display: block;
        min-height: 0;
        max-width: calc(2 * 1.5rem);
        max-height: 100%;
    }

    micro-link-entity p {
        margin: 0;
        text-overflow: ellipsis;
        overflow: hidden;
        color: var(--micro-color-text);
        text-decoration: none;
        font-size: 0.875em;
    }

    micro-link-entity p > span {
        display: inline-block;
        color: var(--micro-color-text);
        text-decoration: none;
    }

    /*micro-link-entity a {
        grid-template-columns: 1fr;
        position: relative;
    }

    micro-link-entity div {
        display: grid;
    }

    micro-link-entity img {
        grid-column-start: 1;
        grid-row-start: 1;
    }

    micro-link-entity p {
        align-self: end;
        grid-column-start: 1;
        grid-row-start: 1;
        width: 100%;
        display: inline-block;
        vertical-align: bottom;
        bottom: 0;
        left: 0;
        right: 0;
        margin: 0;
        padding: calc(1.5em / 4);
        z-index: 1;
        color: #333;
        background: #ddd;
        text-decoration: none;
        text-overflow: ellipsis;
        overflow: hidden;
        max-height: calc(2 * 1.5em + 1.5em / 2);
    }*/
        /*float: right;*/
        /*position: absolute;*/
        /*position: relative;*/
        /*margin-top: -1.5rem;*/
        /*margin-left: -100%;*/

    /*
    micro-link-entity:not(.micro-link-entity-image) i {
        color: #888;
    }

    micro-link-entity.micro-link-entity-image p {
        color: white;
        background: rgba(0, 0, 0, 0.66);
    }

    micro-link-entity p::after {
        content: ' ';
        clear: both;
    }*/
</style>

<template id="micro-image-entity-template">
    <a data-href="entity.url" target="_blank"><img data-src="or entity.url ''" /></a>
</template>

<style>
micro-image-entity img {
    margin: 0 auto;
    display: block;
    max-width: 100%;
    max-height: calc(70ch * 9 / 16);
    max-height: calc(70ch * 9 / 16 / 2);
    object-fit: contain;
}
</style>

<template id="micro-text-entity-input-template">
    <div data-content="renderEntity entity"></div>
    <button is="micro-button" type="button" class="action action-subtle" data-run="remove">
        <i class="fa fa-minus-circle"></i> Remove
    </button>
    <label>
        <textarea data-oninput="input" data-onclick="input" data-onkeyup="input" data-onblur="input" data-onfocus="input"></textarea>
    </label>
    <p>
        <small>
            <i class="fa fa-spinner fa-spin"></i> You can add more content (image, video, …) by
            inserting a link.
        </small>
    </p>
</template>
<style>
    micro-text-entity-input > * {
        margin: calc(1.5rem / 4) 0;
    }

    micro-text-entity-input:not(.micro-text-entity-input-entity) > button,
    micro-text-entity-input:not(.micro-text-entity-input-previewing) > p i {
        display: none;
    }
</style>

<template class="micro-simple-notification-template">
    <div class="micro-ui-inside compact">
        <div class="micro-simple-notification-content"></div>
        <p class="group">
            <button class="micro-simple-notification-dismiss action action-subtle">
                Dismiss
            </button>
        </p>
    </div>
</template>

<template class="micro-error-notification-template">
    <div class="micro-ui-inside compact">
        <p>
            <i class="fa fa-exclamation-triangle"></i> Oops, something went very wrong! We have been
            notified and will do our best to fix the problem as soon as possible. We are sorry for
            the inconvenience!
        </p>
        <p>In the meantime, you may reload the page and give it another try.</p>
        <p class="group">
            <button class="micro-error-notification-reload action">Reload the page</button>
        </p>
    </div>
</template>

<template class="micro-menu-template">
    <button class="micro-menu-toggle-secondary action action-subtle"><i class="fa"></i></button>
</template>

<template class="micro-user-template">
    <i class="fa fa-user"></i><span></span>
</template>

<template class="micro-not-found-page-template">
    <h1 class="micro-icon-title"><i class="fa fa-map-signs"></i></h1>
    <p>Oops, we have not found the page you are looking for!</p>
    <p><small>If you've been here before, someone has deleted what was here.</small></p>
</template>

<template class="micro-forbidden-page-template">
    <h1 class="micro-icon-title"><i class="fa fa-lock"></i></h1>
    <p>Oops, you are not allowed to view this page!<p>
    <p><small>If you've been here before, someone has revoked your permission.</small></p>
</template>

<template class="micro-about-page-template">
    <h1 data-text="About {title}"></h1>
    <p class="micro-about-short"></p>
    <p class="micro-about-provider"></p>

    <section class="micro-about-project">
        <h1>Powered by</h1>
        <p class="micro-logo"><a class="link" target="_blank"><img /> <span></span></a></p>
        <p>
            The service is powered by <a class="micro-about-project-link link" target="_blank"></a>,
            a free and open-source software released under the
            <a class="micro-about-license link" target="_blank"></a>.
        </p>
        <p class="micro-about-copyright"></p>
    </section>
</template>

<template class="micro-edit-user-page-template">
    <h1>Edit user settings</h1>
    <form class="micro-edit-user-edit">
        <label>
            <input name="name" />
            <small>Name</small>
            <small>Your name or nick name.</small>
        </label>
        <p>
            <button class="action"><i class="fa fa-check-circle"></i> Save</button>
        </p>
    </form>

    <section class="micro-edit-user-email">
        <header class="group">
            <h1>Email</h1>
            <div class="micro-edit-user-remove-email">
                <button class="action"><i class="fa fa-trash-o"></i> Remove</button>
            </div>
        </header>

        <div class="micro-edit-user-set-email-1">
            <form>
                <label>
                    <input name="email" type="email" required="required" />
                    <small>Email address</small>
                </label>
                <p>
                    <button class="action">
                        <i class="fa fa-check-circle"></i> Add email address
                    </button>
                </p>
            </form>
        </div>

        <section class="micro-edit-user-set-email-2">
            <h1>Add email address</h1>
            <p>
                We've sent a message to your email address. Please open it and follow the
                instructions.
            </p>
            <p class="micro-edit-user-cancel-set-email"><button class="action">Cancel</button></p>
            <p class="micro-progress"><i class="fa fa-spin fa-spinner"></i></p>
        </section>

        <p class="micro-edit-user-email-value"></p>

        <p><small>The email address is only visible to you.</small></p>
    </section>
</template>

<template class="micro-edit-settings-page-template">
    <h1>Edit site settings</h1>
    <form class="micro-edit-settings-edit">
        <label>
            <input name="title" required="required" />
            <small>Title</small>
        </label>
        <label>
            <input name="icon" />
            <small>Icon (optional)</small>
            <small>URL of the site icon.</small>
        </label>
        <label>
            <input name="favicon" />
            <small>Favicon (optional)</small>
            <small>URL of the site icon optimized for a small size.</small>
        </label>
        <label>
            <input name="provider_name" />
            <small>Service provider name (optional)</small>
        </label>
        <label>
            <input name="provider_url" />
            <small>Service provider website (optional)</small>
            <small>URL of the website of the service provider.</small>
        </label>
        <label>
            <input name="provider_description" />
            <small>Service provider description (optional)</small>
            <small>“The service is provided by Provider, …”</small>
        </label>
        <label>
            <input name="feedback_url" />
            <small>Feedback &amp; help site (optional)</small>
            <small>URL of the feedback site / help desk.</small>
        </label>
        <ul is="micro-menu">
            <li><button class="action"><span class="fa fa-check-circle"></span> Done</button></li>
            <li><a class="link action-cancel" href="/">Cancel</a></li>
        </ul>
    </form>
</template>

<template class="micro-activity-page-template">
    <h1>Site activity</h1>
    <p><small><i class='fa fa-eye'></i> Only visible to staff members</small></p>
    <ul>
        <li class="micro-lgroup">
            <ul class="micro-timeline"></ul>
        </li>
        <li class="micro-activity-show-more">
            <button is="micro-button" class="link">
                <i class="fa fa-ellipsis-v"></i> Show more
            </button>
        </li>
    </ul>
</template>
